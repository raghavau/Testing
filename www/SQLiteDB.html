<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>SQLite DB Plugin</title>
        <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <link rel="stylesheet" type="text/css" href="css/loading.css">
    </head>
    <body>
        <div id="header1" class="headerbar">
            <img alt="logo" class="imglogo" src="img/logo.png"><br>
            <strong><span class="headertext">KRISHNAPATNAM PORT</span></strong><!---->
                <span class="glyphicon glyphicon-earphone"></span>&nbsp;&nbsp;&nbsp;&nbsp;
                <span class="glyphicon glyphicon-info-sign"></span>
        </div>
        <div class="container">
            <div class="page-header">User Info</div>
            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-lg-2">Name</label>
                    <div class="col-lg-10">
                        <input type="text" id="txtname" class="inputtext">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-2">Address</label>
                    <div class="col-lg-10">
                        <textarea id="txtaddress" class="inputtext" rows="5"></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-2">Email</label>
                    <div class="col-lg-10">
                        <input type="text" id="txtemail" class="inputtext">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-2">Mobile No</label>
                    <div class="col-lg-10">
                        <input type="text" id="txtmobile" class="inputtext">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-2"></label>
                    <div class="col-lg-10">
                        <button type="button" class="btn btn-custom">Insert</button>
                    </div>
                </div>
            </form>
        </div>
    </body>
</html>
<script type="text/javascript" src="js/jquery1.11.1-min.js"></script>
<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript">
    var myDB;
    //Open Database Connection
    document.addEventListener("deviceready", onDeviceReady, false);
    function onDeviceReady() {
        myDB = window.sqlitePlugin.openDatabase({ name: "mySQLite.db", location: 'default' });
    }
    $(document).ready(function () {
        //Create new table
        $("#createTable").click(function () {
            myDB.transaction(function (transaction) {
                transaction.executeSql('CREATE TABLE IF NOT EXISTS UserDtls (id integer primary key AUTOINCREMENT, name text, address text, email text, mobileno text)', [],
                function (tx, result) {
                    alert("Table created successfully");
                },
                function (error) {
                    alert("Error occurred while creating the table.");
                });
            });
        });

        //Insert New Data
        $("#insert").click(function () {
            myDB.transaction(function (transaction) {
                var executeQuery = "INSERT INTO UserDtls (name, address, email, mobileno) VALUES (?,?,?,?)";
                transaction.executeSql(executeQuery, [$("#txtname").val(), $("#txtaddress").val(), $("#txtemail").val(), $("#txtmobile").val()],
                function (tx, result) {
                    alert('Inserted');
                },
                function (error) {
                    alert('Error occurred');
                });
            });
        });

        //Display Table Data
        $("#showTable").click(function () {
            $("#TableData").html("");
            myDB.transaction(function (transaction) {
                transaction.executeSql('SELECT * FROM UserDtls', [], function (tx, results) {
                    var len = results.rows.length, i;
                    $("#rowCount").html(len);
                    for (i = 0; i < len; i++) {
                        $("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title +
                        "</td><td>" + results.rows.item(i).desc + "</td><td><a href='edit.html?id=" + results.rows.item(i).id +
                        "&title=" + results.rows.item(i).title + "&desc=" + results.rows.item(i).desc +
                        "'>Edit</a> &nbsp;&nbsp; <a class='delete' href='#' id='" + results.rows.item(i).id + "'>Delete</a></td></tr>");
                    }
                }, null);
            });
        });

        //Delete Data from Database
        $(document.body).on('click', '.delete', function () {
            var id = this.id;
            myDB.transaction(function (transaction) {
                var executeQuery = "DELETE FROM UserDtls where id=?";
                transaction.executeSql(executeQuery, [id],
                //On Success
                function (tx, result) { alert('Delete successfully'); },
                //On Error
                function (error) { alert('Something went Wrong'); });
            });
        });

        //Delete Tables
        $("#update").click(function () {
            var id = $("#id").text();
            var title = $("#title").val();
            var desc = $("#desc").val()
            myDB.transaction(function (transaction) {
                var executeQuery = "UPDATE UserDtls SET title=?, desc=? WHERE id=?";
                transaction.executeSql(executeQuery, [title, desc, id],
                //On Success
                function (tx, result) { alert('Updated successfully'); },
                //On Error
                function (error) { alert('Something went Wrong'); });
            });
        });

        //Drop Tables
        $("#DropTable").click(function () {
            myDB.transaction(function (transaction) {
                var executeQuery = "DROP TABLE  IF EXISTS UserDtls";
                transaction.executeSql(executeQuery, [],
                function (tx, result) { alert('Table deleted successfully.'); },
                function (error) { alert('Error occurred while droping the table.'); }
            );
            });
        });
    });
</script>